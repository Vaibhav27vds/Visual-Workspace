{
  "version": 3,
  "sources": ["../../../../src/cli/lib/login.ts"],
  "sourcesContent": ["import { errors, BaseClient, custom } from \"openid-client\";\nimport {\n  globalConfigPath,\n  rootDirectory,\n  GlobalConfig,\n  getAuthHeaderFromGlobalConfig,\n  bigBrainAPI,\n  logAndHandleAxiosError,\n} from \"./utils.js\";\nimport open from \"open\";\nimport chalk from \"chalk\";\nimport { provisionHost } from \"./config.js\";\nimport { version } from \"../version.js\";\nimport axios, { AxiosRequestConfig } from \"axios\";\nimport {\n  Context,\n  changeSpinner,\n  logError,\n  logFailure,\n  logFinishedStep,\n  logMessage,\n  showSpinner,\n} from \"../../bundler/context.js\";\nimport { Issuer } from \"openid-client\";\nimport inquirer from \"inquirer\";\nimport { hostname } from \"os\";\nimport { execSync } from \"child_process\";\nimport os from \"os\";\n\nconst SCOPE = \"openid email profile\";\n/// This value was created long ago, and cannot be changed easily.\n/// It's just a fixed string used for identifying the Auth0 token, so it's fine\n/// and not user-facing.\nconst AUDIENCE = \"https://console.convex.dev/api/\";\n\n// Per https://github.com/panva/node-openid-client/tree/main/docs#customizing\ncustom.setHttpOptionsDefaults({\n  timeout: parseInt(process.env.OPENID_CLIENT_TIMEOUT || \"10000\"),\n});\n\nasync function writeGlobalConfig(ctx: Context, config: GlobalConfig) {\n  const dirName = rootDirectory();\n  ctx.fs.mkdir(dirName, { allowExisting: true });\n  const path = globalConfigPath();\n  try {\n    ctx.fs.writeUtf8File(path, JSON.stringify(config));\n  } catch (err) {\n    logFailure(\n      ctx,\n      chalk.red(\n        `Failed to write auth config to ${path} with error: ${err as any}`\n      )\n    );\n    return await ctx.crash(1, \"invalid filesystem data\", err);\n  }\n  logFinishedStep(ctx, `Saved credentials to ${formatPathForPrinting(path)}`);\n}\n\nfunction formatPathForPrinting(path: string) {\n  const homedir = os.homedir();\n  if (process.platform === \"darwin\" && path.startsWith(homedir)) {\n    return path.replace(homedir, \"~\");\n  }\n  return path;\n}\n\nexport async function checkAuthorization(\n  ctx: Context,\n  acceptOptIns: boolean\n): Promise<boolean> {\n  const header = await getAuthHeaderFromGlobalConfig(ctx);\n  if (!header) {\n    return false;\n  }\n  try {\n    const resp = await axios.head(`${provisionHost}/api/authorize`, {\n      headers: {\n        Authorization: header,\n        \"Convex-Client\": `npm-cli-${version}`,\n      },\n      // Don't throw an error if this request returns a non-200 status.\n      // Big Brain responds with a variety of error codes -- 401 if the token is correctly-formed but not valid, and either 400 or 500 if the token is ill-formed.\n      // We only care if this check returns a 200 code (so we can skip logging in again) -- any other errors should be silently skipped and we'll run the whole login flow again.\n      validateStatus: (_) => true,\n    });\n    if (resp.status !== 200) {\n      return false;\n    }\n  } catch (e: any) {\n    // This `catch` block should only be hit if a network error was encountered and axios didn't receive any sort of response.\n    logError(\n      ctx,\n      `Unexpected error when authorizing - are you connected to the internet?`\n    );\n    return await logAndHandleAxiosError(ctx, e);\n  }\n\n  // Check that we have optin as well\n  const shouldContinue = await optins(ctx, acceptOptIns);\n  if (!shouldContinue) {\n    return await ctx.crash(1, undefined);\n  }\n  return true;\n}\n\nasync function performDeviceAuthorization(\n  ctx: Context,\n  auth0Client: BaseClient,\n  shouldOpen: boolean\n): Promise<string> {\n  // Device authorization flow follows this guide: https://github.com/auth0/auth0-device-flow-cli-sample/blob/9f0f3b76a6cd56ea8d99e76769187ea5102d519d/cli.js\n  // License: MIT License\n  // Copyright (c) 2019 Auth0 Samples\n  /*\n  The MIT License (MIT)\n\n  Copyright (c) 2019 Auth0 Samples\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in all\n  copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n  */\n\n  // Device Authorization Request - https://tools.ietf.org/html/rfc8628#section-3.1\n  // Get authentication URL\n  let handle;\n  try {\n    handle = await auth0Client.deviceAuthorization({\n      scope: SCOPE,\n      audience: AUDIENCE,\n    });\n  } catch (error) {\n    // We couldn't get verification URL from Auth0, proceed with manual auth\n    const answers = await inquirer.prompt([\n      {\n        type: \"input\",\n        name: \"authToken\",\n        message:\n          \"Open https://dashboard.convex.dev/auth, log in and paste the token here:\",\n      },\n    ]);\n    return answers.authToken;\n  }\n\n  // Device Authorization Response - https://tools.ietf.org/html/rfc8628#section-3.2\n  // Open authentication URL\n  const { verification_uri_complete, user_code, expires_in } = handle;\n  logMessage(\n    ctx,\n    `Visit ${verification_uri_complete} to finish logging in.\\n` +\n      `You should see the following code which expires in ${\n        expires_in % 60 === 0\n          ? `${expires_in / 60} minutes`\n          : `${expires_in} seconds`\n      }: ${user_code}`\n  );\n  if (shouldOpen) {\n    shouldOpen = (\n      await inquirer.prompt([\n        {\n          name: \"openBrowser\",\n          message: `Open the browser?`,\n          type: \"confirm\",\n          default: true,\n        },\n      ])\n    ).openBrowser;\n  }\n\n  if (shouldOpen) {\n    showSpinner(\n      ctx,\n      `Opening ${verification_uri_complete} in your browser to log in...\\n`\n    );\n    try {\n      await open(verification_uri_complete);\n      changeSpinner(ctx, \"Waiting for the confirmation...\");\n    } catch (err: any) {\n      logError(ctx, chalk.red(`Unable to open browser.`));\n      changeSpinner(\n        ctx,\n        `Manually open ${verification_uri_complete} in your browser to log in.`\n      );\n    }\n  } else {\n    showSpinner(\n      ctx,\n      `Open ${verification_uri_complete} in your browser to log in.`\n    );\n  }\n\n  // Device Access Token Request - https://tools.ietf.org/html/rfc8628#section-3.4\n  // Device Access Token Response - https://tools.ietf.org/html/rfc8628#section-3.5\n  try {\n    const tokens = await handle.poll();\n    if (typeof tokens.access_token === \"string\") {\n      return tokens.access_token;\n    } else {\n      // Unexpected error\n      // eslint-disable-next-line no-restricted-syntax\n      throw Error(\"Access token is missing\");\n    }\n  } catch (err: any) {\n    switch (err.error) {\n      case \"access_denied\": // end-user declined the device confirmation prompt, consent or rules failed\n        logFailure(ctx, \"Access denied.\");\n        return await ctx.crash(1, err);\n      case \"expired_token\": // end-user did not complete the interaction in time\n        logFailure(ctx, \"Device flow expired.\");\n        return await ctx.crash(1, err);\n      default:\n        if (err instanceof errors.OPError) {\n          logFailure(\n            ctx,\n            `Error = ${err.error}; error_description = ${err.error_description}`\n          );\n        } else {\n          logFailure(ctx, `Login failed with error: ${err}`);\n        }\n        return await ctx.crash(1, err);\n    }\n  }\n}\n\nasync function performPasswordAuthentication(\n  ctx: Context,\n  issuer: string,\n  clientId: string,\n  username: string,\n  password: string\n): Promise<string> {\n  // Unfortunately, `openid-client` doesn't support the resource owner password credentials flow so we need to manually send the requests.\n  const options: AxiosRequestConfig = {\n    method: \"POST\",\n    url: new URL(\"/oauth/token\", issuer).href,\n    headers: { \"content-type\": \"application/x-www-form-urlencoded\" },\n    data: new URLSearchParams({\n      grant_type: \"password\",\n      username: username,\n      password: password,\n      scope: SCOPE,\n      client_id: clientId,\n      audience: AUDIENCE,\n      // Note that there is no client secret provided, as Auth0 refuses to require it for untrusted apps.\n    }),\n  };\n\n  try {\n    const response = await axios.request(options);\n    if (typeof response.data.access_token === \"string\") {\n      return response.data.access_token;\n    } else {\n      // Unexpected error\n      // eslint-disable-next-line no-restricted-syntax\n      throw Error(\"Access token is missing\");\n    }\n  } catch (err: any) {\n    logFailure(ctx, `Password flow failed: ${err}`);\n    if (err.response) {\n      logError(ctx, chalk.red(`${JSON.stringify(err.response.data)}`));\n    }\n    return await ctx.crash(1, err);\n  }\n}\n\nexport async function performLogin(\n  ctx: Context,\n  {\n    overrideAuthUrl,\n    overrideAuthClient,\n    overrideAuthUsername,\n    overrideAuthPassword,\n    overrideAccessToken,\n    open,\n    acceptOptIns,\n    dumpAccessToken,\n    deviceName: deviceNameOverride,\n  }: {\n    overrideAuthUrl?: string;\n    overrideAuthClient?: string;\n    overrideAuthUsername?: string;\n    overrideAuthPassword?: string;\n    overrideAccessToken?: string;\n    // default `true`\n    open?: boolean;\n    // default `true`\n    acceptOptIns?: boolean;\n    dumpAccessToken?: boolean;\n    deviceName?: string;\n  } = {}\n) {\n  // Get access token from big-brain\n  // Default the device name to the hostname, but allow the user to change this if the terminal is interactive.\n  // On Macs, the `hostname()` may be a weirdly-truncated form of the computer name. Attempt to read the \"real\" name before falling back to hostname.\n  let deviceName = deviceNameOverride ?? \"\";\n  if (!deviceName && process.platform === \"darwin\") {\n    try {\n      deviceName = execSync(\"scutil --get ComputerName\").toString().trim();\n    } catch {\n      // Just fall back to the hostname default below.\n    }\n  }\n  if (!deviceName) {\n    deviceName = hostname();\n  }\n  if (process.stdin.isTTY && !deviceNameOverride) {\n    logMessage(\n      ctx,\n      chalk.bold(`Welcome to developing with Convex, let's get you logged in.`)\n    );\n    const answers = await inquirer.prompt([\n      {\n        type: \"input\",\n        name: \"deviceName\",\n        message: \"Device name:\",\n        default: deviceName,\n      },\n    ]);\n    deviceName = answers.deviceName;\n  }\n\n  const issuer = overrideAuthUrl ?? \"https://auth.convex.dev\";\n  const auth0 = await Issuer.discover(issuer);\n  const clientId = overrideAuthClient ?? \"HFtA247jp9iNs08NTLIB7JsNPMmRIyfi\";\n  const auth0Client = new auth0.Client({\n    client_id: clientId,\n    token_endpoint_auth_method: \"none\",\n    id_token_signed_response_alg: \"RS256\",\n  });\n\n  let accessToken: string;\n  if (overrideAccessToken) {\n    accessToken = overrideAccessToken;\n  } else if (overrideAuthUsername && overrideAuthPassword) {\n    accessToken = await performPasswordAuthentication(\n      ctx,\n      issuer,\n      clientId,\n      overrideAuthUsername,\n      overrideAuthPassword\n    );\n  } else {\n    accessToken = await performDeviceAuthorization(\n      ctx,\n      auth0Client,\n      open ?? true\n    );\n  }\n\n  if (dumpAccessToken) {\n    console.log(`${accessToken}`);\n    return await ctx.crash(0);\n  }\n\n  interface AuthorizeArgs {\n    authnToken: string;\n    deviceName: string;\n  }\n  const authorizeArgs: AuthorizeArgs = {\n    authnToken: accessToken,\n    deviceName: deviceName,\n  };\n  const data = await bigBrainAPI({\n    ctx,\n    method: \"POST\",\n    url: \"authorize\",\n    data: authorizeArgs,\n  });\n  const globalConfig = { accessToken: data.accessToken };\n  try {\n    await writeGlobalConfig(ctx, globalConfig);\n  } catch (err: any) {\n    return await ctx.crash(1, \"invalid filesystem data\", err);\n  }\n\n  // Do opt in to TOS and Privacy Policy stuff\n  const shouldContinue = await optins(ctx, acceptOptIns ?? false);\n  if (!shouldContinue) {\n    return await ctx.crash(1, undefined);\n  }\n}\n\n/// There are fields like version, but we keep them opaque\ntype OptIn = Record<string, unknown>;\n\ntype OptInToAccept = {\n  optIn: OptIn;\n  message: string;\n};\n\ntype AcceptOptInsArgs = {\n  optInsAccepted: OptIn[];\n};\n\n// Returns whether we can proceed or not.\nasync function optins(ctx: Context, acceptOptIns: boolean): Promise<boolean> {\n  const data = await bigBrainAPI({\n    ctx,\n    method: \"POST\",\n    url: \"check_opt_ins\",\n  });\n  if (data.optInsToAccept.length === 0) {\n    return true;\n  }\n  for (const optInToAccept of data.optInsToAccept) {\n    const confirmed =\n      acceptOptIns ||\n      (\n        await inquirer.prompt([\n          {\n            type: \"confirm\",\n            name: \"confirmed\",\n            message: optInToAccept.message,\n          },\n        ])\n      ).confirmed;\n\n    if (!confirmed) {\n      logFailure(ctx, \"Please accept the Terms of Service to use Convex.\");\n      return Promise.resolve(false);\n    }\n  }\n\n  const optInsAccepted = data.optInsToAccept.map((o: OptInToAccept) => o.optIn);\n  const args: AcceptOptInsArgs = { optInsAccepted };\n  await bigBrainAPI({ ctx, method: \"POST\", url: \"accept_opt_ins\", data: args });\n  return true;\n}\n"],
  "mappings": "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",
  "names": ["open"]
}
